{"ast":null,"code":"import axios from 'axios';\n\n// הגדרת axios עם baseURL ישיר - FIXED FOR RENDER\n// שימוש ב-template literal כדי ש-webpack לא יסיר את זה\nconst API_BASE = 'https://' + 'todoapis' + '-' + 'qdh6' + '.' + 'onrender' + '.' + 'com';\nconst apiClient = axios.create({\n  baseURL: API_BASE,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\nconsole.log('API Base URL:', API_BASE);\n\n// מזריק JWT אוטומטית\napiClient.interceptors.request.use(config => {\n  const token = localStorage.getItem('jwt');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n\n// טיפול בשגיאות\napiClient.interceptors.response.use(response => response, error => {\n  var _error$response;\n  console.error('API Error:', ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || error.message);\n  if (error.response && error.response.status === 401) {\n    localStorage.removeItem('jwt');\n    if (window.location.pathname !== '/') {\n      window.location.href = '/';\n    }\n  }\n  return Promise.reject(error);\n});\nexport default {\n  // =====================\n  // Auth\n  // =====================\n  register: async (username, password) => {\n    const result = await apiClient.post('/register', {\n      username,\n      passwordHash: password\n    });\n    return result.data;\n  },\n  login: async (username, password) => {\n    const result = await apiClient.post('/login', {\n      username,\n      password\n    });\n    const token = result.data.token;\n    localStorage.setItem('jwt', token); // שמירת JWT ב-localStorage\n    return token;\n  },\n  logout: () => {\n    localStorage.removeItem('jwt');\n  },\n  // =====================\n  // Tasks\n  // =====================\n  getTasks: async () => {\n    const result = await apiClient.get('/tasks');\n    return result.data;\n  },\n  addTask: async name => {\n    const result = await apiClient.post('/tasks', {\n      name,\n      isComplete: false\n    });\n    return result.data;\n  },\n  setCompleted: async (id, name, isComplete) => {\n    const result = await apiClient.put(`/tasks/${id}`, {\n      id,\n      name,\n      isComplete\n    });\n    return result.data;\n  },\n  deleteTask: async id => {\n    await apiClient.delete(`/tasks/${id}`);\n  }\n};","map":{"version":3,"names":["axios","API_BASE","apiClient","create","baseURL","headers","console","log","interceptors","request","use","config","token","localStorage","getItem","Authorization","response","error","_error$response","data","message","status","removeItem","window","location","pathname","href","Promise","reject","register","username","password","result","post","passwordHash","login","setItem","logout","getTasks","get","addTask","name","isComplete","setCompleted","id","put","deleteTask","delete"],"sources":["C:/Users/user1/Desktop/תכנות-שנה ב/פרקטיקוד/4/ToDoListReact-master/src/service.js"],"sourcesContent":["import axios from 'axios';\n\n// הגדרת axios עם baseURL ישיר - FIXED FOR RENDER\n// שימוש ב-template literal כדי ש-webpack לא יסיר את זה\nconst API_BASE = 'https://' + 'todoapis' + '-' + 'qdh6' + '.' + 'onrender' + '.' + 'com';\nconst apiClient = axios.create({\n  baseURL: API_BASE,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\nconsole.log('API Base URL:', API_BASE);\n\n// מזריק JWT אוטומטית\napiClient.interceptors.request.use((config) => {\n  const token = localStorage.getItem('jwt');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n\n// טיפול בשגיאות\napiClient.interceptors.response.use(\n  response => response,\n  error => {\n    console.error('API Error:', error.response?.data || error.message);\n    if (error.response && error.response.status === 401) {\n      localStorage.removeItem('jwt');\n      if (window.location.pathname !== '/') {\n        window.location.href = '/';\n      }\n    }\n    return Promise.reject(error);\n  }\n);\n\n\nexport default {\n  // =====================\n  // Auth\n  // =====================\n  register: async (username, password) => {\n    const result = await apiClient.post('/register', { username, passwordHash: password });\n    return result.data;\n  },\n\n  login: async (username, password) => {\n    const result = await apiClient.post('/login', { username, password });\n    const token = result.data.token;\n    localStorage.setItem('jwt', token); // שמירת JWT ב-localStorage\n    return token;\n  },\n\n  logout: () => {\n    localStorage.removeItem('jwt');\n  },\n\n  // =====================\n  // Tasks\n  // =====================\n  getTasks: async () => {\n    const result = await apiClient.get('/tasks');\n    return result.data;\n  },\n\n  \n  addTask: async (name) => {\n    const result = await apiClient.post('/tasks', { name, isComplete: false });\n    return result.data;\n  },\n\n  setCompleted: async (id, name, isComplete) => {\n    const result = await apiClient.put(`/tasks/${id}`, { id, name, isComplete });\n    return result.data;\n  },\n\n  deleteTask: async (id) => {\n    await apiClient.delete(`/tasks/${id}`);\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}