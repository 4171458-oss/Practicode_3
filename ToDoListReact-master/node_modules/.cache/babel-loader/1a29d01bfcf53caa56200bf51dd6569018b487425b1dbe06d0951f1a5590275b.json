{"ast":null,"code":"import apiClient from './axiosConfig';\nexport default {\n  // =====================\n  // Auth\n  // =====================\n  register: async (username, password) => {\n    try {\n      const result = await apiClient.post('/register', {\n        username,\n        passwordHash: password\n      });\n      return result.data;\n    } catch (error) {\n      throw error;\n    }\n  },\n  login: async (username, password) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      const result = await axios.post(`${apiUrl}/login`, {\n        username,\n        password\n      }, getConfig());\n      if (typeof result.data === 'string' && result.data.trim() !== '') {\n        try {\n          const parsed = JSON.parse(result.data);\n          if (parsed.token) {\n            localStorage.setItem('jwt', parsed.token);\n            return parsed.token;\n          }\n        } catch (e) {\n          // Continue to normal flow\n        }\n      }\n      if (!result.data || !result.data.token) {\n        throw new Error('No token received from server');\n      }\n      const token = result.data.token;\n      localStorage.setItem('jwt', token);\n      return token;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n  logout: () => {\n    localStorage.removeItem('jwt');\n  },\n  // =====================\n  // Tasks\n  // =====================\n  getTasks: async () => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      const result = await axios.get(`${apiUrl}/tasks`, getConfig());\n      if (Array.isArray(result.data)) {\n        return result.data;\n      }\n      return [];\n    } catch (error) {\n      if (error.response && error.response.status === 401) {\n        localStorage.removeItem('jwt');\n      }\n      throw error;\n    }\n  },\n  addTask: async name => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      const result = await axios.post(`${apiUrl}/tasks`, {\n        name,\n        isComplete: false\n      }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n  setCompleted: async (id, name, isComplete) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      const result = await axios.put(`${apiUrl}/tasks/${id}`, {\n        id,\n        name,\n        isComplete\n      }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n  deleteTask: async id => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      await axios.delete(`${apiUrl}/tasks/${id}`, getConfig());\n    } catch (error) {\n      handleError(error);\n    }\n  }\n};","map":{"version":3,"names":["apiClient","register","username","password","result","post","passwordHash","data","error","login","configResponse","fetch","config","json","apiUrl","API_URL","axios","getConfig","trim","parsed","JSON","parse","token","localStorage","setItem","e","Error","handleError","logout","removeItem","getTasks","get","Array","isArray","response","status","addTask","name","isComplete","setCompleted","id","put","deleteTask","delete"],"sources":["C:/Users/user1/Desktop/תכנות-שנה ב/פרקטיקוד/4/ToDoListReact-master/src/service.js"],"sourcesContent":["import apiClient from './axiosConfig';\n\n\nexport default {\n  // =====================\n  // Auth\n  // =====================\n  register: async (username, password) => {\n    try {\n      const result = await apiClient.post('/register', { username, passwordHash: password });\n      return result.data;\n    } catch (error) {\n      throw error;\n    }\n  },\n\n  login: async (username, password) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      const result = await axios.post(`${apiUrl}/login`, { username, password }, getConfig());\n      \n      if (typeof result.data === 'string' && result.data.trim() !== '') {\n        try {\n          const parsed = JSON.parse(result.data);\n          if (parsed.token) {\n            localStorage.setItem('jwt', parsed.token);\n            return parsed.token;\n          }\n        } catch (e) {\n          // Continue to normal flow\n        }\n      }\n      \n      if (!result.data || !result.data.token) {\n        throw new Error('No token received from server');\n      }\n      \n      const token = result.data.token;\n      localStorage.setItem('jwt', token);\n      return token;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n\n  logout: () => {\n    localStorage.removeItem('jwt');\n  },\n\n  // =====================\n  // Tasks\n  // =====================\n  getTasks: async () => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      const result = await axios.get(`${apiUrl}/tasks`, getConfig());\n      \n      if (Array.isArray(result.data)) {\n        return result.data;\n      }\n      return [];\n    } catch (error) {\n      if (error.response && error.response.status === 401) {\n        localStorage.removeItem('jwt');\n      }\n      throw error;\n    }\n  },\n\n  \n  addTask: async (name) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      const result = await axios.post(`${apiUrl}/tasks`, { name, isComplete: false }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n\n  setCompleted: async (id, name, isComplete) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      const result = await axios.put(`${apiUrl}/tasks/${id}`, { id, name, isComplete }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n\n  deleteTask: async (id) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      await axios.delete(`${apiUrl}/tasks/${id}`, getConfig());\n    } catch (error) {\n      handleError(error);\n    }\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}