{"ast":null,"code":"import apiClient from './axiosConfig';\nexport default {\n  // =====================\n  // Auth\n  // =====================\n  register: async (username, password) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      const result = await axios.post(`${apiUrl}/register`, {\n        username,\n        passwordHash: password\n      }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n  login: async (username, password) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      const result = await axios.post(`${apiUrl}/login`, {\n        username,\n        password\n      }, getConfig());\n      if (typeof result.data === 'string' && result.data.trim() !== '') {\n        try {\n          const parsed = JSON.parse(result.data);\n          if (parsed.token) {\n            localStorage.setItem('jwt', parsed.token);\n            return parsed.token;\n          }\n        } catch (e) {\n          // Continue to normal flow\n        }\n      }\n      if (!result.data || !result.data.token) {\n        throw new Error('No token received from server');\n      }\n      const token = result.data.token;\n      localStorage.setItem('jwt', token);\n      return token;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n  logout: () => {\n    localStorage.removeItem('jwt');\n  },\n  // =====================\n  // Tasks\n  // =====================\n  getTasks: async () => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      const result = await axios.get(`${apiUrl}/tasks`, getConfig());\n      if (Array.isArray(result.data)) {\n        return result.data;\n      }\n      return [];\n    } catch (error) {\n      if (error.response && error.response.status === 401) {\n        localStorage.removeItem('jwt');\n      }\n      throw error;\n    }\n  },\n  addTask: async name => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      const result = await axios.post(`${apiUrl}/tasks`, {\n        name,\n        isComplete: false\n      }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n  setCompleted: async (id, name, isComplete) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      const result = await axios.put(`${apiUrl}/tasks/${id}`, {\n        id,\n        name,\n        isComplete\n      }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n  deleteTask: async id => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      await axios.delete(`${apiUrl}/tasks/${id}`, getConfig());\n    } catch (error) {\n      handleError(error);\n    }\n  }\n};","map":{"version":3,"names":["apiClient","register","username","password","configResponse","fetch","config","json","apiUrl","API_URL","result","axios","post","passwordHash","getConfig","data","error","handleError","login","trim","parsed","JSON","parse","token","localStorage","setItem","e","Error","logout","removeItem","getTasks","get","Array","isArray","response","status","addTask","name","isComplete","setCompleted","id","put","deleteTask","delete"],"sources":["C:/Users/user1/Desktop/תכנות-שנה ב/פרקטיקוד/4/ToDoListReact-master/src/service.js"],"sourcesContent":["import apiClient from './axiosConfig';\n\n\nexport default {\n  // =====================\n  // Auth\n  // =====================\n  register: async (username, password) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      const result = await axios.post(`${apiUrl}/register`, { username, passwordHash: password }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n\n  login: async (username, password) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      const result = await axios.post(`${apiUrl}/login`, { username, password }, getConfig());\n      \n      if (typeof result.data === 'string' && result.data.trim() !== '') {\n        try {\n          const parsed = JSON.parse(result.data);\n          if (parsed.token) {\n            localStorage.setItem('jwt', parsed.token);\n            return parsed.token;\n          }\n        } catch (e) {\n          // Continue to normal flow\n        }\n      }\n      \n      if (!result.data || !result.data.token) {\n        throw new Error('No token received from server');\n      }\n      \n      const token = result.data.token;\n      localStorage.setItem('jwt', token);\n      return token;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n\n  logout: () => {\n    localStorage.removeItem('jwt');\n  },\n\n  // =====================\n  // Tasks\n  // =====================\n  getTasks: async () => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      const result = await axios.get(`${apiUrl}/tasks`, getConfig());\n      \n      if (Array.isArray(result.data)) {\n        return result.data;\n      }\n      return [];\n    } catch (error) {\n      if (error.response && error.response.status === 401) {\n        localStorage.removeItem('jwt');\n      }\n      throw error;\n    }\n  },\n\n  \n  addTask: async (name) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      const result = await axios.post(`${apiUrl}/tasks`, { name, isComplete: false }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n\n  setCompleted: async (id, name, isComplete) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      const result = await axios.put(`${apiUrl}/tasks/${id}`, { id, name, isComplete }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n\n  deleteTask: async (id) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      await axios.delete(`${apiUrl}/tasks/${id}`, getConfig());\n    } catch (error) {\n      handleError(error);\n    }\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}