{"ast":null,"code":"import apiClient from './axiosConfig';\nexport default {\n  // =====================\n  // Auth\n  // =====================\n  register: async (username, password) => {\n    try {\n      const result = await apiClient.post('/register', {\n        username,\n        passwordHash: password\n      });\n      return result.data;\n    } catch (error) {\n      throw error;\n    }\n  },\n  login: async (username, password) => {\n    try {\n      const result = await apiClient.post('/login', {\n        username,\n        password\n      });\n      if (typeof result.data === 'string' && result.data.trim() !== '') {\n        try {\n          const parsed = JSON.parse(result.data);\n          if (parsed.token) {\n            localStorage.setItem('jwt', parsed.token);\n            return parsed.token;\n          }\n        } catch (e) {\n          // Continue to normal flow\n        }\n      }\n      if (!result.data || !result.data.token) {\n        throw new Error('No token received from server');\n      }\n      const token = result.data.token;\n      localStorage.setItem('jwt', token);\n      return token;\n    } catch (error) {\n      throw error;\n    }\n  },\n  logout: () => {\n    localStorage.removeItem('jwt');\n  },\n  // =====================\n  // Tasks\n  // =====================\n  getTasks: async () => {\n    try {\n      const result = await apiClient.get('/tasks');\n      if (Array.isArray(result.data)) {\n        return result.data;\n      }\n      return [];\n    } catch (error) {\n      throw error;\n    }\n  },\n  addTask: async name => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      const result = await axios.post(`${apiUrl}/tasks`, {\n        name,\n        isComplete: false\n      }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n  setCompleted: async (id, name, isComplete) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      const result = await axios.put(`${apiUrl}/tasks/${id}`, {\n        id,\n        name,\n        isComplete\n      }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n  deleteTask: async id => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      await axios.delete(`${apiUrl}/tasks/${id}`, getConfig());\n    } catch (error) {\n      handleError(error);\n    }\n  }\n};","map":{"version":3,"names":["apiClient","register","username","password","result","post","passwordHash","data","error","login","trim","parsed","JSON","parse","token","localStorage","setItem","e","Error","logout","removeItem","getTasks","get","Array","isArray","addTask","name","configResponse","fetch","config","json","apiUrl","API_URL","axios","isComplete","getConfig","handleError","setCompleted","id","put","deleteTask","delete"],"sources":["C:/Users/user1/Desktop/תכנות-שנה ב/פרקטיקוד/4/ToDoListReact-master/src/service.js"],"sourcesContent":["import apiClient from './axiosConfig';\n\n\nexport default {\n  // =====================\n  // Auth\n  // =====================\n  register: async (username, password) => {\n    try {\n      const result = await apiClient.post('/register', { username, passwordHash: password });\n      return result.data;\n    } catch (error) {\n      throw error;\n    }\n  },\n\n  login: async (username, password) => {\n    try {\n      const result = await apiClient.post('/login', { username, password });\n      \n      if (typeof result.data === 'string' && result.data.trim() !== '') {\n        try {\n          const parsed = JSON.parse(result.data);\n          if (parsed.token) {\n            localStorage.setItem('jwt', parsed.token);\n            return parsed.token;\n          }\n        } catch (e) {\n          // Continue to normal flow\n        }\n      }\n      \n      if (!result.data || !result.data.token) {\n        throw new Error('No token received from server');\n      }\n      \n      const token = result.data.token;\n      localStorage.setItem('jwt', token);\n      return token;\n    } catch (error) {\n      throw error;\n    }\n  },\n\n  logout: () => {\n    localStorage.removeItem('jwt');\n  },\n\n  // =====================\n  // Tasks\n  // =====================\n  getTasks: async () => {\n    try {\n      const result = await apiClient.get('/tasks');\n      if (Array.isArray(result.data)) {\n        return result.data;\n      }\n      return [];\n    } catch (error) {\n      throw error;\n    }\n  },\n\n  \n  addTask: async (name) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      const result = await axios.post(`${apiUrl}/tasks`, { name, isComplete: false }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n\n  setCompleted: async (id, name, isComplete) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      const result = await axios.put(`${apiUrl}/tasks/${id}`, { id, name, isComplete }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n\n  deleteTask: async (id) => {\n    try {\n      const configResponse = await fetch('/config.json');\n      const config = await configResponse.json();\n      const apiUrl = config.API_URL || 'https://todoapis-qdh6.onrender.com';\n      \n      await axios.delete(`${apiUrl}/tasks/${id}`, getConfig());\n    } catch (error) {\n      handleError(error);\n    }\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}