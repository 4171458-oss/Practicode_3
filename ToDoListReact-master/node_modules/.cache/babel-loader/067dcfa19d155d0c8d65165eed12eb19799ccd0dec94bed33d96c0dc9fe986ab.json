{"ast":null,"code":"import axios from'axios';// URL של ה-API - FIXED FOR RENDER\nconst API_URL='https://todoapis-qdh6.onrender.com';// פונקציה עזר ליצירת config עם JWT\nconst getConfig=()=>{const token=localStorage.getItem('jwt');const config={headers:{'Content-Type':'application/json'}};if(token){config.headers.Authorization=\"Bearer \".concat(token);}return config;};// פונקציה עזר לטיפול בשגיאות\nconst handleError=error=>{var _error$response;console.error('API Error:',((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data)||error.message);if(error.response&&error.response.status===401){localStorage.removeItem('jwt');if(window.location.pathname!=='/'){window.location.href='/';}}throw error;};export default{// =====================\n// Auth\n// =====================\nregister:async(username,password)=>{try{const result=await axios.post(\"\".concat(API_URL,\"/register\"),{username,passwordHash:password},getConfig());return result.data;}catch(error){return handleError(error);}},login:async(username,password)=>{try{const result=await axios.post(\"\".concat(API_URL,\"/login\"),{username,password},getConfig());const token=result.data.token;localStorage.setItem('jwt',token);return token;}catch(error){return handleError(error);}},logout:()=>{localStorage.removeItem('jwt');},// =====================\n// Tasks\n// =====================\ngetTasks:async()=>{try{const result=await axios.get(\"\".concat(API_URL,\"/tasks\"),getConfig());return result.data;}catch(error){return handleError(error);}},addTask:async name=>{try{const result=await axios.post(\"\".concat(API_URL,\"/tasks\"),{name,isComplete:false},getConfig());return result.data;}catch(error){return handleError(error);}},setCompleted:async(id,name,isComplete)=>{try{const result=await axios.put(\"\".concat(API_URL,\"/tasks/\").concat(id),{id,name,isComplete},getConfig());return result.data;}catch(error){return handleError(error);}},deleteTask:async id=>{try{await axios.delete(\"\".concat(API_URL,\"/tasks/\").concat(id),getConfig());}catch(error){return handleError(error);}}};","map":{"version":3,"names":["axios","API_URL","getConfig","token","localStorage","getItem","config","headers","Authorization","concat","handleError","error","_error$response","console","response","data","message","status","removeItem","window","location","pathname","href","register","username","password","result","post","passwordHash","login","setItem","logout","getTasks","get","addTask","name","isComplete","setCompleted","id","put","deleteTask","delete"],"sources":["C:/Users/user1/Desktop/תכנות-שנה ב/פרקטיקוד/4/ToDoListReact-master/src/service.js"],"sourcesContent":["import axios from 'axios';\n\n// URL של ה-API - FIXED FOR RENDER\nconst API_URL = 'https://todoapis-qdh6.onrender.com';\n\n// פונקציה עזר ליצירת config עם JWT\nconst getConfig = () => {\n  const token = localStorage.getItem('jwt');\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n};\n\n// פונקציה עזר לטיפול בשגיאות\nconst handleError = (error) => {\n  console.error('API Error:', error.response?.data || error.message);\n  if (error.response && error.response.status === 401) {\n    localStorage.removeItem('jwt');\n    if (window.location.pathname !== '/') {\n      window.location.href = '/';\n    }\n  }\n  throw error;\n};\n\n\nexport default {\n  // =====================\n  // Auth\n  // =====================\n  register: async (username, password) => {\n    try {\n      const result = await axios.post(`${API_URL}/register`, { username, passwordHash: password }, getConfig());\n      return result.data;\n    } catch (error) {\n      return handleError(error);\n    }\n  },\n\n  login: async (username, password) => {\n    try {\n      const result = await axios.post(`${API_URL}/login`, { username, password }, getConfig());\n      const token = result.data.token;\n      localStorage.setItem('jwt', token);\n      return token;\n    } catch (error) {\n      return handleError(error);\n    }\n  },\n\n  logout: () => {\n    localStorage.removeItem('jwt');\n  },\n\n  // =====================\n  // Tasks\n  // =====================\n  getTasks: async () => {\n    try {\n      const result = await axios.get(`${API_URL}/tasks`, getConfig());\n      return result.data;\n    } catch (error) {\n      return handleError(error);\n    }\n  },\n\n  \n  addTask: async (name) => {\n    try {\n      const result = await axios.post(`${API_URL}/tasks`, { name, isComplete: false }, getConfig());\n      return result.data;\n    } catch (error) {\n      return handleError(error);\n    }\n  },\n\n  setCompleted: async (id, name, isComplete) => {\n    try {\n      const result = await axios.put(`${API_URL}/tasks/${id}`, { id, name, isComplete }, getConfig());\n      return result.data;\n    } catch (error) {\n      return handleError(error);\n    }\n  },\n\n  deleteTask: async (id) => {\n    try {\n      await axios.delete(`${API_URL}/tasks/${id}`, getConfig());\n    } catch (error) {\n      return handleError(error);\n    }\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}