{"ast":null,"code":"import axios from'axios';// URL של ה-API - FIXED FOR RENDER - ישירות בכל קריאה\n// פונקציה עזר ליצירת config עם JWT\nconst getConfig=()=>{const token=localStorage.getItem('jwt');const config={headers:{'Content-Type':'application/json'}};if(token){config.headers.Authorization=\"Bearer \".concat(token);}return config;};// פונקציה עזר לטיפול בשגיאות\nconst handleError=error=>{var _error$response;console.error('API Error:',((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data)||error.message);if(error.response&&error.response.status===401){localStorage.removeItem('jwt');if(window.location.pathname!=='/'){window.location.href='/';}}throw error;};export default{// =====================\n// Auth\n// =====================\nregister:async(username,password)=>{try{const result=await axios.post('https://todoapis-qdh6.onrender.com/register',{username,passwordHash:password},getConfig());return result.data;}catch(error){handleError(error);}},login:async(username,password)=>{try{const result=await axios.post('https://todoapis-qdh6.onrender.com/login',{username,password},getConfig());const token=result.data.token;localStorage.setItem('jwt',token);return token;}catch(error){handleError(error);}},logout:()=>{localStorage.removeItem('jwt');},// =====================\n// Tasks\n// =====================\ngetTasks:async()=>{try{const result=await axios.get('https://todoapis-qdh6.onrender.com/tasks',getConfig());// וודא שהתוצאה היא מערך\nif(Array.isArray(result.data)){return result.data;}// אם זה לא מערך, נחזיר מערך ריק\nreturn[];}catch(error){var _error$response2;console.error('Get tasks error:',((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.data)||error.message);// אם יש שגיאת 401, נטפל בה אבל לא נזרוק שגיאה\nif(error.response&&error.response.status===401){localStorage.removeItem('jwt');if(window.location.pathname!=='/'){window.location.href='/';}}// תמיד מחזירים מערך ריק במקום לזרוק שגיאה\nreturn[];}},addTask:async name=>{try{const result=await axios.post('https://todoapis-qdh6.onrender.com/tasks',{name,isComplete:false},getConfig());return result.data;}catch(error){handleError(error);}},setCompleted:async(id,name,isComplete)=>{try{const result=await axios.put(\"https://todoapis-qdh6.onrender.com/tasks/\".concat(id),{id,name,isComplete},getConfig());return result.data;}catch(error){handleError(error);}},deleteTask:async id=>{try{await axios.delete(\"https://todoapis-qdh6.onrender.com/tasks/\".concat(id),getConfig());}catch(error){handleError(error);}}};","map":{"version":3,"names":["axios","getConfig","token","localStorage","getItem","config","headers","Authorization","concat","handleError","error","_error$response","console","response","data","message","status","removeItem","window","location","pathname","href","register","username","password","result","post","passwordHash","login","setItem","logout","getTasks","get","Array","isArray","_error$response2","addTask","name","isComplete","setCompleted","id","put","deleteTask","delete"],"sources":["C:/Users/user1/Desktop/תכנות-שנה ב/פרקטיקוד/4/ToDoListReact-master/src/service.js"],"sourcesContent":["import axios from 'axios';\n\n// URL של ה-API - FIXED FOR RENDER - ישירות בכל קריאה\n\n// פונקציה עזר ליצירת config עם JWT\nconst getConfig = () => {\n  const token = localStorage.getItem('jwt');\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n};\n\n// פונקציה עזר לטיפול בשגיאות\nconst handleError = (error) => {\n  console.error('API Error:', error.response?.data || error.message);\n  if (error.response && error.response.status === 401) {\n    localStorage.removeItem('jwt');\n    if (window.location.pathname !== '/') {\n      window.location.href = '/';\n    }\n  }\n  throw error;\n};\n\n\nexport default {\n  // =====================\n  // Auth\n  // =====================\n  register: async (username, password) => {\n    try {\n      const result = await axios.post('https://todoapis-qdh6.onrender.com/register', { username, passwordHash: password }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n\n  login: async (username, password) => {\n    try {\n      const result = await axios.post('https://todoapis-qdh6.onrender.com/login', { username, password }, getConfig());\n      const token = result.data.token;\n      localStorage.setItem('jwt', token);\n      return token;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n\n  logout: () => {\n    localStorage.removeItem('jwt');\n  },\n\n  // =====================\n  // Tasks\n  // =====================\n  getTasks: async () => {\n    try {\n      const result = await axios.get('https://todoapis-qdh6.onrender.com/tasks', getConfig());\n      // וודא שהתוצאה היא מערך\n      if (Array.isArray(result.data)) {\n        return result.data;\n      }\n      // אם זה לא מערך, נחזיר מערך ריק\n      return [];\n    } catch (error) {\n      console.error('Get tasks error:', error.response?.data || error.message);\n      // אם יש שגיאת 401, נטפל בה אבל לא נזרוק שגיאה\n      if (error.response && error.response.status === 401) {\n        localStorage.removeItem('jwt');\n        if (window.location.pathname !== '/') {\n          window.location.href = '/';\n        }\n      }\n      // תמיד מחזירים מערך ריק במקום לזרוק שגיאה\n      return [];\n    }\n  },\n\n  \n  addTask: async (name) => {\n    try {\n      const result = await axios.post('https://todoapis-qdh6.onrender.com/tasks', { name, isComplete: false }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n\n  setCompleted: async (id, name, isComplete) => {\n    try {\n      const result = await axios.put(`https://todoapis-qdh6.onrender.com/tasks/${id}`, { id, name, isComplete }, getConfig());\n      return result.data;\n    } catch (error) {\n      handleError(error);\n    }\n  },\n\n  deleteTask: async (id) => {\n    try {\n      await axios.delete(`https://todoapis-qdh6.onrender.com/tasks/${id}`, getConfig());\n    } catch (error) {\n      handleError(error);\n    }\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}